{% extends "base.html" %}
{% load static %}

{% block title %}{{ service.title }} - Services | Konimba Djimiga{% endblock %}
{% block meta_description %}{{ service.description|striptags|truncatewords:30 }}{% endblock %}
{% block og_title %}{{ service.title }} - Services{% endblock %}
{% block og_description %}{{ service.description|striptags|truncatewords:30 }}{% endblock %}
{% block canonical_url %}{{ request.build_absolute_uri }}{% endblock %}
{% if service.image %}
{% block og_image %}{{ request.scheme }}://{{ request.get_host }}{{ service.image.url }}{% endblock %}
{% endif %}

{% block structured_data %}
{{ block.super }}
<!-- Service Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Service",
  "serviceType": "{{ service.get_category_display|escapejs }}",
  "name": "{{ service.title|escapejs }}",
  "description": "{{ service.description|striptags|truncatewords:50|escapejs }}",
  "provider": {
    "@type": "Person",
    "name": "Konimba Djimiga",
    "url": "{{ request.scheme }}://{{ request.get_host }}"
  },
  "areaServed": {
    "@type": "Country",
    "name": "France"
  },
  "url": "{{ request.build_absolute_uri }}"{% if service.price %},
  "offers": {
    "@type": "Offer",
    "price": "{{ service.price }}",
    "priceCurrency": "EUR",
    "availability": "https://schema.org/InStock",
    "url": "{{ request.build_absolute_uri }}"
  }{% endif %}{% if service.image %},
  "image": "{{ request.scheme }}://{{ request.get_host }}{{ service.image.url }}"{% endif %}
}
</script>
{% endblock %}

{% block content %}

<section class="relative py-12 lg:py-16 font-inter">
  <!-- Fond décoratif -->
  <div class="absolute inset-0 -z-10 pointer-events-none">
    <div class="absolute -top-32 -left-32 w-72 h-72 bg-gradient-to-br from-brand-500/10 to-accent-500/10 rounded-full blur-3xl"></div>
    <div class="absolute -bottom-32 -right-32 w-72 h-72 bg-gradient-to-tr from-accent-500/10 to-brand-500/10 rounded-full blur-3xl"></div>
  </div>

  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Fil d'Ariane amélioré (SEO) -->
    <nav class="mb-6" aria-label="Breadcrumb">
      <ol class="flex flex-wrap items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-neutral-500 dark:text-neutral-400">
        <li class="flex items-center">
          <a href="{% url 'portfolio-index' %}" class="hover:text-brand-600 dark:hover:text-brand-400 transition-colors">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
            <span class="hidden sm:inline">Accueil</span>
          </a>
        </li>
        <li class="flex items-center">
          <svg class="w-4 h-4 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </li>
        <li class="flex items-center">
          <a href="{% url 'services:service_list' %}" class="hover:text-brand-600 dark:hover:text-brand-400 transition-colors">Services</a>
        </li>
        <li class="flex items-center">
          <svg class="w-4 h-4 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </li>
        <li class="flex items-center">
          <span class="text-neutral-700 dark:text-neutral-200 font-medium">{{ service.title|truncatechars:40 }}</span>
        </li>
      </ol>
    </nav>

    <div class="bg-white dark:bg-neutral-900 rounded-xl lg:rounded-2xl shadow-lg border border-neutral-200 dark:border-neutral-800 overflow-hidden">
      <!-- En-tête -->
      <div class="p-6 lg:p-8 border-b border-neutral-200 dark:border-neutral-800 flex flex-col lg:flex-row gap-6 lg:gap-8 items-start lg:items-center justify-between">
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-[11px] font-semibold
                          {% if service.category == 'web_app' %}
                            bg-brand-50 text-brand-700 dark:bg-brand-900/40 dark:text-brand-200 border border-brand-100 dark:border-brand-800
                          {% elif service.category == 'maintenance' %}
                            bg-emerald-50 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-200 border border-emerald-100 dark:border-emerald-800
                          {% else %}
                            bg-accent-50 text-accent-700 dark:bg-accent-900/40 dark:text-accent-200 border border-accent-100 dark:border-accent-800
                          {% endif %}">
              {{ service.get_category_display }}
            </span>
            <span class="text-xs font-semibold text-neutral-500 dark:text-neutral-400">
              {{ service.get_type_display }}
            </span>
          </div>

          <h1 class="text-2xl lg:text-3xl font-extrabold text-neutral-900 dark:text-white">
            {{ service.title }}
          </h1>

          <div class="flex flex-wrap items-center gap-3 text-sm">
            {% if service.price %}
            <div class="text-neutral-700 dark:text-neutral-200">
              À partir de
              <span class="font-bold text-brand-600 dark:text-brand-400">
                {{ service.price }} €
              </span>
            </div>
            {% endif %}
            <span class="text-neutral-500 dark:text-neutral-400">
              • {{ service.duration }}
            </span>
          </div>
        </div>

        {% if service.image %}
        <div class="w-full lg:w-56 h-44 lg:h-44 rounded-xl overflow-hidden shadow-md border border-neutral-200 dark:border-neutral-700 bg-neutral-900 dark:bg-neutral-900">
          <img
            src="{{ service.image.url }}"
            alt="{{ service.title }}"
            class="w-full h-full object-cover object-top"
            loading="lazy"
          />
        </div>
        {% endif %}
      </div>

      <!-- Contenu -->
      <div class="p-6 lg:p-8 grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-10">
        <!-- Colonne principale -->
        <div class="lg:col-span-2 space-y-6">
          <section>
            <h2 class="text-sm font-semibold uppercase tracking-wide text-neutral-500 dark:text-neutral-400 mb-2">
              Description
            </h2>
            <div class="prose prose-sm sm:prose-base max-w-none dark:prose-invert prose-a:text-brand-600 dark:prose-a:text-brand-400">
              {{ service.description|safe }}
            </div>
          </section>

          <section>
            <h2 class="text-sm font-semibold uppercase tracking-wide text-neutral-500 dark:text-neutral-400 mb-2">
              Fonctionnalités incluses
            </h2>
            <div class="prose prose-sm sm:prose-base max-w-none dark:prose-invert">
              {{ service.features|safe }}
            </div>
          </section>

          <!-- Bloc contextuel supplémentaire selon le type de service -->
          <section class="bg-neutral-50 dark:bg-neutral-800/60 rounded-lg border border-neutral-200 dark:border-neutral-700 p-4 sm:p-5">
            {% if service.category == 'web_app' %}
              <h2 class="text-sm font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-300 mb-2">
                Ce que vous obtenez concrètement
              </h2>
              <ul class="text-sm text-neutral-700 dark:text-neutral-200 space-y-1.5 list-disc list-inside">
                <li>Une application web pensée pour vos usages réels (back‑office, clients, collaborateurs).</li>
                <li>Une base de code structurée (Django) facile à faire évoluer dans le temps.</li>
                <li>Une architecture prête pour l’hébergement (PostgreSQL, S3, déploiement cloud).</li>
                <li>Une interface responsive utilisable sur ordinateur, tablette et mobile.</li>
              </ul>
            {% elif service.category == 'maintenance' %}
              <h2 class="text-sm font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-300 mb-2">
                Ce qui est pris en charge
              </h2>
              <ul class="text-sm text-neutral-700 dark:text-neutral-200 space-y-1.5 list-disc list-inside">
                <li>Analyse de l’existant et priorisation des correctifs les plus critiques.</li>
                <li>Mises à jour régulières de Django, des dépendances et de l’infrastructure.</li>
                <li>Optimisations ciblées sur les performances (requêtes, stockage, assets).</li>
                <li>Accompagnement pour faire évoluer progressivement votre application.</li>
              </ul>
            {% endif %}
          </section>
        </div>

        <!-- Colonne latérale -->
        <aside class="space-y-6">
          <section class="bg-neutral-50 dark:bg-neutral-800/80 rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
            <h3 class="text-sm font-semibold text-neutral-900 dark:text-white mb-2">
              Stack technique
            </h3>
            <p class="text-xs text-neutral-600 dark:text-neutral-300 whitespace-pre-line">
              {{ service.technical_stack }}
            </p>
          </section>

          {% with feature_list=service.get_features_list %}
          {% if feature_list %}
          <section class="bg-neutral-50 dark:bg-neutral-800/80 rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
            <h3 class="text-sm font-semibold text-neutral-900 dark:text-white mb-2">
              Points forts de cette offre
            </h3>
            <ul class="text-xs text-neutral-700 dark:text-neutral-300 space-y-1.5">
              {% for f in feature_list %}
              <li class="flex items-start gap-1.5">
                <span class="mt-[3px] h-1.5 w-1.5 rounded-full bg-brand-500"></span>
                <span>{{ f }}</span>
              </li>
              {% endfor %}
            </ul>
          </section>
          {% endif %}
          {% endwith %}

          <section class="bg-gradient-to-br from-brand-500 to-accent-500 rounded-lg p-4 text-white shadow-md">
            <h3 class="text-sm font-semibold mb-2">
              Discutons de votre projet
            </h3>
            <p class="text-xs text-brand-50/90 mb-3">
              Ce service vous intéresse ? Contactez-moi pour adapter l’offre à votre contexte
              (budget, planning, fonctionnalités).
            </p>
            <a
              href="{% url 'about' %}#contact"
              class="inline-flex items-center justify-center w-full px-3 py-2 text-xs font-semibold rounded-md bg-white/10 hover:bg-white/20 transition-colors"
            >
              Me contacter
            </a>
          </section>
        </aside>
      </div>
    </div>
  </div>
</section>

{% endblock %}


